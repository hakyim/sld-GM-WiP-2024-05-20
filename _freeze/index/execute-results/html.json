{
  "hash": "5a868a40b3e998d1650e5e3f768599e0",
  "result": {
    "markdown": "---\nformat:\n  revealjs:\n    slide-number: c/t\n    width: 1600\n    height: 900\n    css: [\"theme/theme.css\"]\n    theme: [simple,theme/mystyle.scss]\n    echo: true\neditor: source\nfreeze: true\npdf-separate-fragments: true\n---\n\n\n<!-- begin ----------------------------- -->\n# Im Lab Work in Progress {background-color=\"white\"}\n<br>\n\n<h2>Genetic Medicine, UChicago</h2>\n\n<h3>2023-05-20 Wednesday</h3>\n\n<h3>Hae Kyung Im</h3>\n<!-- end ----------------------------- -->\n\n\n<!-- begin ----------------------------- -->\n# Goal: develop statistical methods to link genetic variation with phenotypic variation  {background-color=\"white\"}\n<!-- end ----------------------------- -->\n\n\n<!-- begin ----------------------------- -->\n## What is TWAS?{.nostretch background-image=assets/slide-background.svg}\n\n. . . \n\n<br>\nIt's a method that tries to identify causal genes of GWAS loci\n\n. . . \n\n<br>\nGWAS discoveries continue to grow but causal genes are not known\n\n\n![](assets/gwas-catalog-2024-04-10.png){width=50%}\n\n<small>downloaded April 2024 from GWAS Catalog </small>\n<!-- end ----------------------------- -->\n\n\n<!-- begin ----------------------------- -->\n## TWAS uses GWAS data to find genes associated with trait {background-image=assets/slide-background.svg}\n\n![](assets/gwas-predixcan-diagram){width=1200}\n\n::: {.absolute bottom=0 left=0 .fragment .fade-out}\n![](assets/blank-rectangle.png){width=\"1600\" height=\"380\" fig-alt=\"blank\"}\n:::\n<!-- end ----------------------------- -->\n\n\n<!-- begin ----------------------------- -->\n## Gene expression can be predicted from genotype {background-image=assets/slide-background.svg}\n\n![](assets/reference-transcriptome-gtex.png)\n\n<!-- begin ----------------------------- -->\n## Some genes are very well predicted {background-image=assets/slide-background.svg}\n\n![](assets/performance-top-genes.png)\n\n<!-- begin ----------------------------- -->\n## Accuracy of prediction depends on heritability {.nostretch  background-image=assets/slide-background.svg}\n\n![](assets/performance-all-genes.png){width=75%}\n\n\n<!-- begin ----------------------------- -->\n## Advantages of gene level associations {background-image=assets/slide-background.svg visibility=hidden}\n\n- Reduced multiple testing burden (from 10e6 to 10e4)\n- The function of genes are much better annotated than SNPs\n- Validation in other model systems is possible\n- Reverse causality issues is less problematic because disease status doesn’t affect germline genetic markers \n- It provides the direction of effects, i.e. whether up or down regulation of a gene - increases the risk of a disease\n- The candidate causal gene is a good target for drug development\n\n<!-- begin ----------------------------- -->\n## PrediXcan results identify drug repositioning candidates {\n.nostretch \nbackground-image=assets/slide-background.svg \nvisibility=hidden\n}\n\n![](assets/so-drug-repurposing.png){width=75%}\n\n:::aside\nSo et al, Nature Neuroscience 2017\n::: \n<!-- end ----------------------------- -->\n\n<!-- begin ----------------------------- -->\n## PrediXcan Results Are Predictive of Drug Target Success {\nbackground-image=assets/slide-background.svg\nvisibility=hidden}\n\n![](assets/successful-drugs-higher-twas-signal.png)\n<!-- end ----------------------------- -->\n\n<!-- begin ----------------------------- -->\n## Limitations of TWAS  {\nbackground-image=assets/slide-background.svg \nvisibility=hidden\n}\n\n:::{.columns}\n\n:::{.column width=75%}\n\n- Not very good at predicting low heritability genes which are more likely to be disease relevant\n- Predictions don’t transfer well across ancestries\n- Effect of rare variation is missed\n- Steady state eQTL may not be disease relevant\n\n:::\n:::\n<!-- end ----------------------------- -->\n\n<!-- begin ----------------------------- -->\n## TWAS extensions are actively being developed {background-image=assets/slide-background.svg .nostretch }\n\n![](assets/omnixcan.png){width=80%}\n\n. . . \n\nit uses genetic predictors of omic traits to bridge the gap between genotype and phenotype\n\n# Short interlude in statistical genetics {background-color=\"white\"}\n<br>\n\n. . . \n\nIs it important to have a calibrated type I error (false positive rate)?\n\n<br>\n\n. . . \n\nYes!\n<br>\n<br>\n\n. . . \n\nIf you don't care about type I error, reject every test and you will have 100% power.\n<!-- end ----------------------------- -->\n\n<!-- begin ----------------------------- -->\n## Check calibration of TWAS type I error {background-image=assets/slide-background.svg}\n\n:::{.columns}\n  \n:::{.column width=40%}\n  \n<br>\nTWAS model\n<br>\n\n \n\\begin{align*}\nY &= \\beta ~ T +  \\epsilon_\\text{twas} \\\\\n\nT &= \\sum_k X_k ~  \\gamma_k  \\quad \\epsilon_\\text{twas} \\perp\\!\\!\\!\\perp T\n\\end{align*}\n\n\n:::{.fragment}\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbeta = 0\nN = 1000\nM = 999\nmaf=0.4\netwas = rnorm(N)\ngamma = rnorm(M)\nX = matrix(rbinom(N*M,2,maf),N,M)\nT = X %*% gamma \nY = beta * T + etwas\nfit = lm(Y ~ T)\n```\n:::\n\n:::\n\n:::{.fragment}\n<br>\ncalculate $\\chi^2 = \\hat{\\beta}/\\text{se}(\\hat\\beta)^2$\n\n:::\n\n\n:::\n\n\n:::{.column width=60%}\n\n\n:::{.fragment}\n\nrepeat 1000 times \n\n:::\n\n\n::: {.fragment}\nunder the null, we expect $\\chi^2$ to follow $\\chi^2_1$ and $E \\chi^2 = 1$\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](index_files/figure-revealjs/unnamed-chunk-1-1.png){width=960}\n:::\n:::\n\n\n\n:::\n\n::: {.fragment}\n$~~~~~~~~~~~~~~$[No inflation]{style=\"color: blue; font-size: 2em;\"}\n:::\n\n\n\n:::\n\n:::\n<!-- end ----------------------------- -->\n\n<!-- begin ----------------------------- -->\n\n## What if Y is polygenic? {.nostretch background-image=assets/slide-background.svg}\n\n:::{.columns}\n  \n:::{.column width=40%}\n\n\\begin{align*}\n\nY &= \\beta ~ T + \\epsilon_\\text{twas}\\\\\n\n\nT &= \\sum_k X_k ~ \\gamma_k\n\n\\end{align*}\n\n:::{.fragment}\n\n$$\\epsilon_\\text{twas} = \\sum_k X_k ~ \\delta_k + \\epsilon$$\n:::\n\n:::{.fragment}\n$$\\epsilon, ~\\gamma,~ \\delta   \\perp\\!\\!\\!\\perp ~ \\therefore ~ T \\perp\\!\\!\\!\\perp \\epsilon_\\text{twas}$$\n:::\n\n:::{.fragment}\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbeta = 0\nN = 1000\nM = 999\nmaf=0.4\nepsi = rnorm(N)\ngamma = rnorm(M)\ndelta = rnorm(M)\nX = matrix(rbinom(N*M,2,maf),N,M)\nT = X %*% gamma \nY = beta * T + X %*% delta + epsi\nfit = lm(Y ~ T)\n```\n:::\n\n\n:::\n\n:::\n\n\n:::{.column width=60%}\n\n:::{.fragment}\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](index_files/figure-revealjs/unnamed-chunk-2-1.png){width=960}\n:::\n:::\n\n\n\n:::\n\n::: {.fragment}\n$~~~~~~~~$[Now we do see inflation]{style=\"color: blue; font-size: 2em;\"}\n:::\n\n\n:::\n\n:::\n<!-- end ----------------------------- -->\n\n<!-- begin ----------------------------- -->\n## How does inflation vary with sample size? {background-image=assets/slide-background.svg}\n<!-- end ----------------------------- -->\n\n![](assets/twas-null-echi2-vs-nsam.png)\n\n\n<!-- begin ----------------------------- -->\n## How does inflation vary with heritability of Y? {background-image=assets/slide-background.svg}\n<!-- end ----------------------------- -->\n\n![](assets/twas-null-echi2-vs-h2.png)\n\n<!-- begin ----------------------------- -->\n## How does inflation vary with the number of SNPs? {background-image=assets/slide-background.svg}\n<!-- end ----------------------------- -->\n\n![](assets/twas-null-echi2-vs-msnp.png)\n\n\n<!-- begin ----------------------------- -->\n## What does the inflation look like {background-image=assets/slide-background.svg}\n\n[$$ E \\chi^2 \\approx N h^2 \\frac{1}{M} ?$$]{style=\"font-size: 1.5em;\"}\n\n. . . \n\nif we do the math, we get\n[$$ E \\chi^2 \\approx\n1 +  N ~ h^2 \\frac{1}{M} \\Phi_1$$]{style=\"font-size: 1.5em;\"}\n\n. . . \n\n\n$$ \\text{where } \\Phi_1  = \\frac{\\tilde\\gamma' \\cdot \\Sigma^2  \\cdot \\tilde\\gamma}{\\tilde\\gamma' \\cdot  \\Sigma  \\cdot \\tilde\\gamma}  $$\n\n. . . \n\nwhen SNPs are independent,\n$\\Phi_1 = 1$ so that \n $~~~E \\chi^2 = 1 + N h^2 \\frac{1}{M}$ pretty close to our guess\n\n## We can derive a more general expression {background-image=assets/slide-background.svg}\n\n<br>\n\n[$$E~\\chi^2_\\text{twas} \\approx 1  + N ~h^2_\\delta \\frac{1}{M}~ \\frac{\\Phi_1}{1 - \\beta^2\\tau^2} +  N ~ \\frac{\\beta^2 }{1 - \\beta^2\\tau^2}~\\tau^2$$]{style=\"font-size: 1.7em;\"}\n\n\n<br><br><br><br>\n[Polygenic $Y$ and Noisy Mediator;  $\\tau^2 =\\text{precision} = \\text{signal to noise ratio} = \\frac{\\text{var}(T)}{\\text{var}(\\tilde{T})}$]{style=\"font-size: 0.8em;\"}\n<!-- end ----------------------------- -->\n\n\n<!-- begin ----------------------------- -->\n## Can we correct the inflation? {background-image=assets/slide-background.svg}\n\n::: {.incremental}\n\n<br>\n\n- Yes!\n<br>\n\n- Use noncentral χ2 to compute p-values\n<br>\n\n- $\\texttt{pchisq(chi2, ncp=N*h2Y*phi0, df=1, lower.tail=FALSE)}$\n\n:::\n<!-- end ----------------------------- -->\n\n\n<!-- begin ----------------------------- -->\n## On the problem of inflation in TWAS (under review) {background-image=assets/slide-background.svg}\n![](assets/twas-inflation-biorxiv.png)\n\n\n::: {.absolute bottom=-90 right=-18}\n![](assets/yanyu-and-festus.png){width=500}\n:::\n<!-- end ----------------------------- -->\n\n\n<!-- begin ----------------------------- -->\n## RatXcan corrects inflation with mixed effects approach {background-image=assets/slide-background.svg}\n![](assets/ratxcan-biorxiv.png)\n<!-- end ----------------------------- -->\n\n\n\n\n<!-- begin ----------------------------- -->\n# Back to TWAS {background-color=\"white\"}\n<!-- end ----------------------------- -->\n\n\n<!-- begin ----------------------------- -->\n## Limitations of TWAS {background-image=assets/slide-background.svg .nostretch }\n\n<br><br>\n\n::::{.columns}\n\n:::{.column width=\"70%\"}\n\n- bulk RNA may not reveal disease relevant regulation\n<br>\n<br>\n\n- context-specific regulation is likely to be more relevant\n<br>\n<br>\n\n- transcription factor binding alteration may affect disease\n\n:::\n\n:::{.column width=\"30%\"}\n\n:::{.fragment}\n- scPrediXcan\n<br>\n<br>\n\n- conteXcan\n<br>\n<br>\n\n- TFXcan\n:::\n\n:::\n\n::::\n\n:::{.fragment}\n<br><br>\n[Generating data with sufficient reads and sample sizes is too costly]{style=\"font-size: 1.3em;\"}\n:::\n<!-- end ----------------------------- -->\n\n<!-- begin ----------------------------- -->\n# Can deep learning help? {background-color=\"white\"}\n<!-- end ----------------------------- -->\n\n<!-- begin ----------------------------- -->\n## Enformer predicts epigenetic features from DNA sequence {background-image=assets/slide-background.svg .nostretch }\n![](assets/enformer-input-output.png){width=75%}\n\n[250 million parameters, 4.6K TPU hours]{style=\"font-size: 0.7em\"}\n\n:::{.absolute right=0 bottom=0}\n[$~~~~~~~~~~~~~~~~$ Avsec et al Nature Methods 2021]{style=\"font-size: 0.5em\"}\n:::\n<!-- end ----------------------------- -->\n\n<!-- begin ----------------------------- -->\n## Enformer predicts epigenetic features from DNA sequence {background-image=assets/slide-background.svg .nostretch }\n$~~~~~~$ ![](assets/enformer-track-performance.png){width=85%}\n\n:::{.absolute right=0 bottom=0}\n[$~~~~~~~~~~~~~~~~$ Avsec et al Nature Methods 2021]{style=\"font-size: 0.5em\"}\n:::\n<!-- end ----------------------------- -->\n\n<!-- begin ----------------------------- -->\n## Enformer trained to perform well across the genome {background-image=assets/slide-background.svg .nostretch }\n$~~~~~~~~~~~~~~~~$ ![](assets/enformer-dimensions-genomic-population-01.png){width=99%}\n<!-- end ----------------------------- -->\n\n<!-- begin ----------------------------- -->\n## Enformer trained to perform well across the genome {background-image=assets/slide-background.svg .nostretch }\n$~~~~~~~~~~~~~~~~$ ![](assets/enformer-dimensions-genomic-population-02.png){width=99%}\n<!-- end ----------------------------- -->\n\n<!-- begin ----------------------------- -->\n## Enformer trained to perform well across the genome {background-image=assets/slide-background.svg .nostretch }\n$~~~~~~~~~~~~~~~~$ ![](assets/enformer-dimensions-genomic-population-03.png){width=99%}\n<!-- end ----------------------------- -->\n\n<!-- begin ----------------------------- -->\n# Can enformer predict variation across individuals?  {background-color=\"white\"}\n<!-- end ----------------------------- -->\n\n\n<!-- begin ----------------------------- -->\n## Enformer can predict variation across individuals - PEX6 {background-image=assets/slide-background.svg .nostretch }\n![](assets/pex6-enformer.png){width=75%}\n\n::: {.absolute bottom=-90 right=-18}\n![](assets/temi-sai.png){width=400}\n:::\n\n<!-- end ----------------------------- -->\n\n<!-- begin ----------------------------- -->\n## but correlation can be negative - NUDT2 {background-image=assets/slide-background.svg .nostretch }\n![](assets/nudt2-enformer.png){width=75%}\n\n::: {.absolute bottom=-90 right=-18}\n![](assets/temi-sai.png){width=400}\n:::\n<!-- end ----------------------------- -->\n\n\n\n<!-- begin ----------------------------- -->\n## Personal transcriptome poorly explained {background-image=assets/slide-background.svg .nostretch }\n\n![](assets/enformer-problem-NG.png)\n\n<!-- end ----------------------------- -->\n\n\n<!-- begin ----------------------------- -->\n## Mean correlation across genes vs. across individuals {background-image=assets/slide-background.svg .nostretch }\n\n![](assets/cross-individual-enformer-comparison-huang.png)\n\n<!-- end ----------------------------- -->\n\n\n<!-- begin ----------------------------- -->\n## Average correlation hides utility of unsigned of prediction {background-image=assets/slide-background.svg .nostretch }\n\n![](assets/enformer-vs-predixcan.png){width=60%}\n\n:::{.absolute right=0 bottom=0}\n[Huang et al 2023 NG]{style=\"font-size: 1em\"}\n:::\n<!-- end ----------------------------- -->\n\n<!-- begin ----------------------------- -->\n## Average correlation hides utility of unsigned of prediction {background-image=assets/slide-background.svg .nostretch }\n\n![](assets/glass_people.png){width=95%}\n\n:::{.absolute right=0 bottom=0}\n[https://what-if.xkcd.com/6/]{style=\"font-size: 1em\"}\n:::\n<!-- end ----------------------------- -->\n\n\n<!-- begin ----------------------------- -->\n## Enpact Method - Training {background-image=assets/slide-background.svg .nostretch }\n\n![](assets/enpact-method.png)\n\nFor training, population average is used, \nso only a handful of samples are needed\n\n<!-- end ----------------------------- -->\n\n\n<!-- begin ----------------------------- -->\n## Validation of Enpact prediction compared to observed {background-image=assets/slide-background.svg .nostretch }\n\n![](assets/TF-enpact-vs-observed.png){width=99%}\n\n::: {.absolute bottom=-90 right=-18}\n![](assets/temi.png){width=200}\n:::\n\n. . . \n\n[Prediction performance is comparable to population-based method with 130 samples]{style=\"font-size=2em;\"}\n\n<!-- end ----------------------------- -->\n\n<!-- begin ----------------------------- -->\n## Validation of Enpact prediction compared to other predictors  {background-image=assets/slide-background.svg .nostretch }\n\n![](assets/enpact-vs-cwas.png)\n\n::: {.absolute top=100 right=10}\nTop site by correlation\n:::\n\n\n::: {.absolute bottom=-90 right=-18}\n![](assets/temi.png){width=200}\n:::\n<!-- end ----------------------------- -->\n\n\n<!-- begin ----------------------------- -->\n## Most enpact predictors correlate significantly with CWAS {background-image=assets/slide-background.svg .nostretch }\n\n![](assets/TF-enpact-vs-cwas-01.png)\n\n::: {.absolute bottom=-90 right=-18}\n![](assets/temi.png){width=200}\n:::\n<!-- end ----------------------------- -->\n\n<!-- begin ----------------------------- -->\n## Enpact CWAS correlation sign is also inconsistent {background-image=assets/slide-background.svg .nostretch }  \n\n![](assets/TF-enpact-vs-cwas-02.png)\n\n::: {.absolute bottom=-90 right=-18}\n![](assets/temi.png){width=200}\n:::\n<!-- end ----------------------------- -->\n\n<!-- begin ----------------------------- -->\n## TFXcan identifies TFBinding associated with disease  {background-image=assets/slide-background.svg .nostretch }\n![](assets/tfxcan.svg){width=90%}\n\n::: {.absolute bottom=-90 right=-18}\n![](assets/temi.png){width=200}\n:::\n\n<!-- end ----------------------------- -->\n\n<!-- begin ----------------------------- -->\n## Identifying TF binding altered by ovarian cancer GWAS variants  {background-image=assets/slide-background.svg .nostretch }\n\n\n![](assets/ovarian-tfxcan.png){width=110%}\n\n::: {.absolute bottom=-70 right=-18}\n![](assets/sofia.png){width=200}\n:::\n\n:::{.absolute bottom=-60 right=200}\n [Sofia Salazar]{style=\"font-size: 0.6em\"}\n:::\n<!-- end ----------------------------- -->\n\n\n<!-- begin ----------------------------- -->\n## Context specific expression prediction {background-image=assets/slide-background.svg .nostretch }\n\n::: {.absolute bottom=-70 right=-18}\n![](assets/sai.png){width=200}\n:::\n\n:::{.absolute bottom=-60 right=200}\n [Sai Gona]{style=\"font-size: 0.6em\"}\n:::\n<!-- end ----------------------------- -->\n\n<!-- begin ----------------------------- -->\n<!-- ## Transcription factor binding prediction (Temidayo Adeluwa){background-image=assets/slide-background.svg .nostretch } -->\n\n<!-- ::: {.absolute bottom=-70 right=-18} -->\n<!-- ![](assets/temi.png){width=200} -->\n<!-- ::: -->\n<!-- end ----------------------------- -->\n\n\n\n\n<!-- begin ----------------------------- -->\n## Single cell expression prediction and association with disease {background-image=assets/slide-background.svg .nostretch }\n\n![](assets/scpredixcan-overview.png){width=70%}\n\n::: {.absolute bottom=-70 right=-70}\n![](assets/charles-mengjie.png){width=400}\n:::\n\n<!-- :::{.absolute bottom=-60 right=200} -->\n<!--  [Charles Zhou]{style=\"font-size: 0.6em\"} -->\n<!-- ::: -->\n<!-- end ----------------------------- -->\n\n\n\n<!-- begin ----------------------------- -->\n# Questions? {background-color=\"white\"}\n<!-- end ----------------------------- -->\n\n\n\n\n\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-after-body": [
        "\n<script>\n  // htmlwidgets need to know to resize themselves when slides are shown/hidden.\n  // Fire the \"slideenter\" event (handled by htmlwidgets.js) when the current\n  // slide changes (different for each slide format).\n  (function () {\n    // dispatch for htmlwidgets\n    function fireSlideEnter() {\n      const event = window.document.createEvent(\"Event\");\n      event.initEvent(\"slideenter\", true, true);\n      window.document.dispatchEvent(event);\n    }\n\n    function fireSlideChanged(previousSlide, currentSlide) {\n      fireSlideEnter();\n\n      // dispatch for shiny\n      if (window.jQuery) {\n        if (previousSlide) {\n          window.jQuery(previousSlide).trigger(\"hidden\");\n        }\n        if (currentSlide) {\n          window.jQuery(currentSlide).trigger(\"shown\");\n        }\n      }\n    }\n\n    // hookup for slidy\n    if (window.w3c_slidy) {\n      window.w3c_slidy.add_observer(function (slide_num) {\n        // slide_num starts at position 1\n        fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);\n      });\n    }\n\n  })();\n</script>\n\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}